
Episode : 1 sum_costs : -3213.76 Avg Reward : -3213.76
Episode : 2 sum_costs : -3248.79 Avg Reward : -3231.28
Episode : 3 sum_costs : -3240.15 Avg Reward : -3234.23
Episode : 4 sum_costs : -3039.15 Avg Reward : -3185.46
Episode : 5 sum_costs : -3253.00 Avg Reward : -3198.97
Episode : 6 sum_costs : -3210.14 Avg Reward : -3200.83
Episode : 7 sum_costs : -3170.10 Avg Reward : -3196.44
Episode : 8 sum_costs : -3122.62 Avg Reward : -3187.21
Episode : 9 sum_costs : -3194.66 Avg Reward : -3188.04
Episode : 10 sum_costs : -3211.62 Avg Reward : -3190.40
Episode : 11 sum_costs : -3179.80 Avg Reward : -3189.44
Episode : 12 sum_costs : -3193.53 Avg Reward : -3189.78
Episode : 13 sum_costs : -3152.32 Avg Reward : -3186.90
Episode : 14 sum_costs : -3055.93 Avg Reward : -3177.54
Episode : 15 sum_costs : -3193.51 Avg Reward : -3178.61
Episode : 16 sum_costs : -3177.09 Avg Reward : -3178.51
Episode : 17 sum_costs : -3119.25 Avg Reward : -3175.02
Episode : 18 sum_costs : -3192.96 Avg Reward : -3176.02
Episode : 19 sum_costs : -3133.69 Avg Reward : -3173.79
Episode : 20 sum_costs : -3182.22 Avg Reward : -3174.21
Episode : 21 sum_costs : -3207.36 Avg Reward : -3175.79
Episode : 22 sum_costs : -3175.75 Avg Reward : -3175.79
Episode : 23 sum_costs : -3151.00 Avg Reward : -3174.71
Episode : 24 sum_costs : -3206.62 Avg Reward : -3176.04
Episode : 25 sum_costs : -3116.76 Avg Reward : -3173.67
Episode : 26 sum_costs : -3101.81 Avg Reward : -3170.91
Episode : 27 sum_costs : -3099.77 Avg Reward : -3168.27
Episode : 28 sum_costs : -3134.62 Avg Reward : -3167.07
Episode : 29 sum_costs : -3141.04 Avg Reward : -3166.17
Episode : 30 sum_costs : -3141.73 Avg Reward : -3165.36
Episode : 31 sum_costs : -3157.27 Avg Reward : -3165.10
Episode : 32 sum_costs : -3180.16 Avg Reward : -3165.57
Episode : 33 sum_costs : -3207.17 Avg Reward : -3166.83
Episode : 34 sum_costs : -3148.61 Avg Reward : -3166.29
Episode : 35 sum_costs : -3196.91 Avg Reward : -3167.17
Episode : 36 sum_costs : -3105.85 Avg Reward : -3165.46
Episode : 37 sum_costs : -3216.13 Avg Reward : -3166.83
Episode : 38 sum_costs : -3210.00 Avg Reward : -3167.97
Episode : 39 sum_costs : -3079.08 Avg Reward : -3165.69
Episode : 40 sum_costs : -3140.28 Avg Reward : -3165.06
Episode : 41 sum_costs : -3001.28 Avg Reward : -3161.06
Episode : 42 sum_costs : -3139.02 Avg Reward : -3160.54
Episode : 43 sum_costs : -3146.74 Avg Reward : -3160.22
Episode : 44 sum_costs : -3246.03 Avg Reward : -3162.17
Episode : 45 sum_costs : -3200.48 Avg Reward : -3163.02
Episode : 46 sum_costs : -3150.96 Avg Reward : -3162.75
Episode : 47 sum_costs : -3263.91 Avg Reward : -3164.91
Episode : 48 sum_costs : -3133.34 Avg Reward : -3164.25
Episode : 49 sum_costs : -3161.74 Avg Reward : -3164.20
Episode : 50 sum_costs : -2960.82 Avg Reward : -3160.13
Episode : 51 sum_costs : -2968.03 Avg Reward : -3156.36
Episode : 52 sum_costs : -3014.44 Avg Reward : -3153.63
Episode : 53 sum_costs : -3021.12 Avg Reward : -3151.13
Episode : 54 sum_costs : -3137.30 Avg Reward : -3150.88
Episode : 55 sum_costs : -3067.95 Avg Reward : -3149.37
Episode : 56 sum_costs : -2820.90 Avg Reward : -3143.51
Episode : 57 sum_costs : -3124.72 Avg Reward : -3143.18
Episode : 58 sum_costs : -3049.97 Avg Reward : -3141.57
Episode : 59 sum_costs : -3144.59 Avg Reward : -3141.62
Episode : 60 sum_costs : -3014.71 Avg Reward : -3139.50
Episode : 61 sum_costs : -3034.44 Avg Reward : -3137.78
Episode : 62 sum_costs : -3052.57 Avg Reward : -3136.41
Episode : 63 sum_costs : -2914.44 Avg Reward : -3132.88
Episode : 64 sum_costs : -3023.88 Avg Reward : -3131.18
Episode : 65 sum_costs : -3046.18 Avg Reward : -3129.87
Episode : 66 sum_costs : -3098.61 Avg Reward : -3129.40
Episode : 67 sum_costs : -3068.62 Avg Reward : -3128.49
Episode : 68 sum_costs : -2916.13 Avg Reward : -3125.37
Episode : 69 sum_costs : -3008.49 Avg Reward : -3123.68
Episode : 70 sum_costs : -2984.82 Avg Reward : -3121.69
Episode : 71 sum_costs : -3017.16 Avg Reward : -3120.22
Episode : 72 sum_costs : -2957.47 Avg Reward : -3117.96
Episode : 73 sum_costs : -3030.89 Avg Reward : -3116.77
Episode : 74 sum_costs : -3112.63 Avg Reward : -3116.71
Episode : 75 sum_costs : -2905.84 Avg Reward : -3113.90
Episode : 76 sum_costs : -2722.51 Avg Reward : -3108.75
Episode : 77 sum_costs : -3034.89 Avg Reward : -3107.79
Episode : 78 sum_costs : -2951.95 Avg Reward : -3105.79
Episode : 79 sum_costs : -2713.57 Avg Reward : -3100.83
Episode : 80 sum_costs : -2685.64 Avg Reward : -3095.64
Episode : 81 sum_costs : -3039.33 Avg Reward : -3094.94
Episode : 82 sum_costs : -3045.25 Avg Reward : -3094.34
Episode : 83 sum_costs : -2975.31 Avg Reward : -3092.90
Episode : 84 sum_costs : -2944.87 Avg Reward : -3091.14
Episode : 85 sum_costs : -3041.36 Avg Reward : -3090.55
Episode : 86 sum_costs : -2839.74 Avg Reward : -3087.64
Episode : 87 sum_costs : -3020.95 Avg Reward : -3086.87
Episode : 88 sum_costs : -3046.50 Avg Reward : -3086.41
Episode : 89 sum_costs : -2859.05 Avg Reward : -3083.86
Episode : 90 sum_costs : -2993.09 Avg Reward : -3082.85
Episode : 91 sum_costs : -2937.48 Avg Reward : -3081.25
Episode : 92 sum_costs : -3048.06 Avg Reward : -3080.89
Episode : 93 sum_costs : -2794.25 Avg Reward : -3077.81
Episode : 94 sum_costs : -2966.39 Avg Reward : -3076.62
Episode : 95 sum_costs : -2805.88 Avg Reward : -3073.77
Episode : 96 sum_costs : -2819.55 Avg Reward : -3071.13
Episode : 97 sum_costs : -2991.41 Avg Reward : -3070.30
Episode : 98 sum_costs : -3027.67 Avg Reward : -3069.87
Episode : 99 sum_costs : -2625.23 Avg Reward : -3065.38
Episode : 100 sum_costs : -2874.42 Avg Reward : -3063.47
Episode : 101 sum_costs : -3009.27 Avg Reward : -3061.42
Episode : 102 sum_costs : -2825.84 Avg Reward : -3057.19
Episode : 103 sum_costs : -3009.78 Avg Reward : -3054.89
Episode : 104 sum_costs : -2966.28 Avg Reward : -3054.16
Episode : 105 sum_costs : -3041.56 Avg Reward : -3052.05
Episode : 106 sum_costs : -2971.49 Avg Reward : -3049.66
Episode : 107 sum_costs : -2991.52 Avg Reward : -3047.87
Episode : 108 sum_costs : -3083.28 Avg Reward : -3047.48
Episode : 109 sum_costs : -2931.23 Avg Reward : -3044.85
Episode : 110 sum_costs : -3030.84 Avg Reward : -3043.04
Episode : 111 sum_costs : -2920.37 Avg Reward : -3040.44
Episode : 112 sum_costs : -2867.59 Avg Reward : -3037.19
Episode : 113 sum_costs : -2657.62 Avg Reward : -3032.24
Episode : 114 sum_costs : -2738.03 Avg Reward : -3029.06
Episode : 115 sum_costs : -2989.05 Avg Reward : -3027.01
Episode : 116 sum_costs : -3045.35 Avg Reward : -3025.70
Episode : 117 sum_costs : -2802.69 Avg Reward : -3022.53
Episode : 118 sum_costs : -2648.41 Avg Reward : -3017.09
Episode : 119 sum_costs : -2882.87 Avg Reward : -3014.58
Episode : 120 sum_costs : -3022.59 Avg Reward : -3012.98
Episode : 121 sum_costs : -2832.71 Avg Reward : -3009.24
Episode : 122 sum_costs : -2854.86 Avg Reward : -3006.03
Episode : 123 sum_costs : -2845.74 Avg Reward : -3002.97
Episode : 124 sum_costs : -2738.69 Avg Reward : -2998.29
Episode : 125 sum_costs : -2788.12 Avg Reward : -2995.01
Episode : 126 sum_costs : -2779.46 Avg Reward : -2991.78
Episode : 127 sum_costs : -2446.60 Avg Reward : -2985.25
Episode : 128 sum_costs : -2632.20 Avg Reward : -2980.23
Episode : 129 sum_costs : -3057.84 Avg Reward : -2979.40
Episode : 130 sum_costs : -3011.13 Avg Reward : -2978.09
Episode : 131 sum_costs : -3015.08 Avg Reward : -2976.67
Episode : 132 sum_costs : -2942.21 Avg Reward : -2974.29
Episode : 133 sum_costs : -2802.51 Avg Reward : -2970.24
Episode : 134 sum_costs : -2779.31 Avg Reward : -2966.55
Episode : 135 sum_costs : -2942.73 Avg Reward : -2964.01
Episode : 136 sum_costs : -2938.17 Avg Reward : -2962.33
Episode : 137 sum_costs : -3065.08 Avg Reward : -2960.82
Episode : 138 sum_costs : -2911.48 Avg Reward : -2957.84
Episode : 139 sum_costs : -2840.87 Avg Reward : -2955.45
Episode : 140 sum_costs : -3095.57 Avg Reward : -2955.01
Episode : 141 sum_costs : -3044.50 Avg Reward : -2955.44
Episode : 142 sum_costs : -2819.19 Avg Reward : -2952.24
Episode : 143 sum_costs : -3083.77 Avg Reward : -2951.61
Episode : 144 sum_costs : -3015.52 Avg Reward : -2949.31
Episode : 145 sum_costs : -3074.76 Avg Reward : -2948.05
Episode : 146 sum_costs : -3003.32 Avg Reward : -2946.57
Episode : 147 sum_costs : -2916.14 Avg Reward : -2943.09
Episode : 148 sum_costs : -3013.50 Avg Reward : -2941.90
Episode : 149 sum_costs : -3057.07 Avg Reward : -2940.85
Episode : 150 sum_costs : -3012.92 Avg Reward : -2941.37
Episode : 151 sum_costs : -2678.84 Avg Reward : -2938.48
Episode : 152 sum_costs : -3043.52 Avg Reward : -2938.77
Episode : 153 sum_costs : -3004.61 Avg Reward : -2938.60
Episode : 154 sum_costs : -2983.44 Avg Reward : -2937.07
Episode : 155 sum_costs : -3047.68 Avg Reward : -2936.86
Episode : 156 sum_costs : -3016.68 Avg Reward : -2938.82
Episode : 157 sum_costs : -2981.46 Avg Reward : -2937.39
Episode : 158 sum_costs : -2559.61 Avg Reward : -2932.48
Episode : 159 sum_costs : -2993.24 Avg Reward : -2930.97
Episode : 160 sum_costs : -2879.20 Avg Reward : -2929.62
Episode : 161 sum_costs : -2415.91 Avg Reward : -2923.43
Episode : 162 sum_costs : -2652.94 Avg Reward : -2919.43
Episode : 163 sum_costs : -2649.20 Avg Reward : -2916.78
Episode : 164 sum_costs : -2688.48 Avg Reward : -2913.43
Episode : 165 sum_costs : -2884.04 Avg Reward : -2911.81
Episode : 166 sum_costs : -2916.25 Avg Reward : -2909.98
Episode : 167 sum_costs : -2868.35 Avg Reward : -2907.98
Episode : 168 sum_costs : -3005.97 Avg Reward : -2908.88
Episode : 169 sum_costs : -2860.41 Avg Reward : -2907.40
Episode : 170 sum_costs : -2933.12 Avg Reward : -2906.88
Episode : 171 sum_costs : -2869.19 Avg Reward : -2905.40
Episode : 172 sum_costs : -2815.54 Avg Reward : -2903.98
Episode : 173 sum_costs : -3047.31 Avg Reward : -2904.15
Episode : 174 sum_costs : -2943.62 Avg Reward : -2902.46
Episode : 175 sum_costs : -2879.72 Avg Reward : -2902.19
Episode : 176 sum_costs : -2870.07 Avg Reward : -2903.67
Episode : 177 sum_costs : -2852.94 Avg Reward : -2901.85
Episode : 178 sum_costs : -2783.96 Avg Reward : -2900.17
Episode : 179 sum_costs : -2723.85 Avg Reward : -2900.27
Episode : 180 sum_costs : -2569.29 Avg Reward : -2899.11
Episode : 181 sum_costs : -2771.28 Avg Reward : -2896.43
Episode : 182 sum_costs : -2807.19 Avg Reward : -2894.05
Episode : 183 sum_costs : -2743.46 Avg Reward : -2891.73
Episode : 184 sum_costs : -2870.19 Avg Reward : -2890.98
Episode : 185 sum_costs : -2938.25 Avg Reward : -2889.95
Episode : 186 sum_costs : -2939.21 Avg Reward : -2890.95
Episode : 187 sum_costs : -2406.49 Avg Reward : -2884.80
Episode : 188 sum_costs : -2794.65 Avg Reward : -2882.28
Episode : 189 sum_costs : -2777.86 Avg Reward : -2881.47
Episode : 190 sum_costs : -2637.14 Avg Reward : -2877.91
Episode : 191 sum_costs : -2583.70 Avg Reward : -2874.37
Episode : 192 sum_costs : -3052.34 Avg Reward : -2874.42
Episode : 193 sum_costs : -2986.94 Avg Reward : -2876.34
Episode : 194 sum_costs : -2659.97 Avg Reward : -2873.28
Episode : 195 sum_costs : -2793.06 Avg Reward : -2873.15
Episode : 196 sum_costs : -2812.90 Avg Reward : -2873.09
Episode : 197 sum_costs : -2759.59 Avg Reward : -2870.77
Episode : 198 sum_costs : -2789.70 Avg Reward : -2868.39
Episode : 199 sum_costs : -2926.90 Avg Reward : -2871.40
Episode : 200 sum_costs : -2553.32 Avg Reward : -2868.19
Episode : 201 sum_costs : -2542.78 Avg Reward : -2863.53
Episode : 202 sum_costs : -2992.50 Avg Reward : -2865.19
Episode : 203 sum_costs : -2970.84 Avg Reward : -2864.81
Episode : 204 sum_costs : -2763.89 Avg Reward : -2862.78
Episode : 205 sum_costs : -2983.67 Avg Reward : -2862.20
Episode : 206 sum_costs : -2913.72 Avg Reward : -2861.62
Episode : 207 sum_costs : -2857.46 Avg Reward : -2860.28
Episode : 208 sum_costs : -2871.68 Avg Reward : -2858.17
Episode : 209 sum_costs : -3073.16 Avg Reward : -2859.59
Episode : 210 sum_costs : -2599.12 Avg Reward : -2855.27
Episode : 211 sum_costs : -2814.91 Avg Reward : -2854.22
Episode : 212 sum_costs : -2844.03 Avg Reward : -2853.98
Episode : 213 sum_costs : -2673.53 Avg Reward : -2854.14
Episode : 214 sum_costs : -2815.47 Avg Reward : -2854.91
Episode : 215 sum_costs : -2970.94 Avg Reward : -2854.73
Episode : 216 sum_costs : -2901.40 Avg Reward : -2853.29
Episode : 217 sum_costs : -2653.91 Avg Reward : -2851.81
Episode : 218 sum_costs : -2908.52 Avg Reward : -2854.41
Episode : 219 sum_costs : -2925.09 Avg Reward : -2854.83
Episode : 220 sum_costs : -2764.99 Avg Reward : -2852.25
Episode : 221 sum_costs : -2769.63 Avg Reward : -2851.62
Episode : 222 sum_costs : -2635.87 Avg Reward : -2849.43
Episode : 223 sum_costs : -2609.57 Avg Reward : -2847.07
Episode : 224 sum_costs : -3138.18 Avg Reward : -2851.06
Episode : 225 sum_costs : -3018.74 Avg Reward : -2853.37
Episode : 226 sum_costs : -2814.38 Avg Reward : -2853.72
Episode : 227 sum_costs : -2765.03 Avg Reward : -2856.90
Episode : 228 sum_costs : -2330.56 Avg Reward : -2853.89
Episode : 229 sum_costs : -2996.54 Avg Reward : -2853.28
Episode : 230 sum_costs : -2877.29 Avg Reward : -2851.94
Episode : 231 sum_costs : -2529.66 Avg Reward : -2847.08
Episode : 232 sum_costs : -3005.51 Avg Reward : -2847.72
Episode : 233 sum_costs : -2811.35 Avg Reward : -2847.80
Episode : 234 sum_costs : -2950.17 Avg Reward : -2849.51
Episode : 235 sum_costs : -2892.41 Avg Reward : -2849.01
Episode : 236 sum_costs : -2944.27 Avg Reward : -2849.07
Episode : 237 sum_costs : -2906.37 Avg Reward : -2847.48
Episode : 238 sum_costs : -2944.83 Avg Reward : -2847.82
Episode : 239 sum_costs : -2969.17 Avg Reward : -2849.10
Episode : 240 sum_costs : -2853.50 Avg Reward : -2846.68
Episode : 241 sum_costs : -2565.01 Avg Reward : -2841.88
Episode : 242 sum_costs : -2727.60 Avg Reward : -2840.97
Episode : 243 sum_costs : -2865.40 Avg Reward : -2838.78
Episode : 244 sum_costs : -2520.22 Avg Reward : -2833.83
Episode : 245 sum_costs : -2699.68 Avg Reward : -2830.08
Episode : 246 sum_costs : -2679.41 Avg Reward : -2826.84
Episode : 247 sum_costs : -2484.29 Avg Reward : -2822.52
Episode : 248 sum_costs : -2887.10 Avg Reward : -2821.26
Episode : 249 sum_costs : -2815.14 Avg Reward : -2818.84
Saving model...
Episode : 250 sum_costs : -2743.93 Avg Reward : -2816.15
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
Episode : 251 sum_costs : -2794.12 Avg Reward : -2817.30
Episode : 252 sum_costs : -2948.84 Avg Reward : -2816.36
Episode : 253 sum_costs : -2949.32 Avg Reward : -2815.80
Episode : 254 sum_costs : -2850.50 Avg Reward : -2814.47
Episode : 255 sum_costs : -2921.77 Avg Reward : -2813.21
Episode : 256 sum_costs : -3034.00 Avg Reward : -2813.39
Episode : 257 sum_costs : -2935.20 Avg Reward : -2812.93
Episode : 258 sum_costs : -2823.92 Avg Reward : -2815.57
Episode : 259 sum_costs : -2803.66 Avg Reward : -2813.67
Episode : 260 sum_costs : -2799.86 Avg Reward : -2812.88
Episode : 261 sum_costs : -2594.83 Avg Reward : -2814.67
Episode : 262 sum_costs : -2575.10 Avg Reward : -2813.89
Episode : 263 sum_costs : -2469.27 Avg Reward : -2812.09
Episode : 264 sum_costs : -2896.55 Avg Reward : -2814.17
Episode : 265 sum_costs : -2788.77 Avg Reward : -2813.22
Episode : 266 sum_costs : -2738.15 Avg Reward : -2811.44
Episode : 267 sum_costs : -2548.80 Avg Reward : -2808.24
Episode : 268 sum_costs : -2408.01 Avg Reward : -2802.26
Episode : 269 sum_costs : -2313.50 Avg Reward : -2796.79
Episode : 270 sum_costs : -2592.25 Avg Reward : -2793.38
Episode : 271 sum_costs : -2655.26 Avg Reward : -2791.25
Episode : 272 sum_costs : -2486.06 Avg Reward : -2787.95
Episode : 273 sum_costs : -2612.39 Avg Reward : -2783.60
Episode : 274 sum_costs : -2582.59 Avg Reward : -2779.99
Episode : 275 sum_costs : -2514.26 Avg Reward : -2776.34
Episode : 276 sum_costs : -2755.37 Avg Reward : -2775.19
Episode : 277 sum_costs : -2505.52 Avg Reward : -2771.72
Episode : 278 sum_costs : -2342.08 Avg Reward : -2767.30
Episode : 279 sum_costs : -2420.20 Avg Reward : -2764.26
Episode : 280 sum_costs : -2462.40 Avg Reward : -2763.19
Episode : 281 sum_costs : -2356.85 Avg Reward : -2759.05
Episode : 282 sum_costs : -2589.79 Avg Reward : -2756.87
Episode : 283 sum_costs : -2499.04 Avg Reward : -2754.43
Episode : 284 sum_costs : -2123.48 Avg Reward : -2746.96
Episode : 285 sum_costs : -2661.08 Avg Reward : -2744.19
Episode : 286 sum_costs : -2591.25 Avg Reward : -2740.71
Episode : 287 sum_costs : -2554.62 Avg Reward : -2742.19
Episode : 288 sum_costs : -2766.04 Avg Reward : -2741.91
Episode : 289 sum_costs : -2481.36 Avg Reward : -2738.94
Episode : 290 sum_costs : -2704.53 Avg Reward : -2739.61
Episode : 291 sum_costs : -2621.35 Avg Reward : -2739.99
Episode : 292 sum_costs : -2754.67 Avg Reward : -2737.01
Episode : 293 sum_costs : -2848.17 Avg Reward : -2735.63
Episode : 294 sum_costs : -2407.09 Avg Reward : -2733.10
Episode : 295 sum_costs : -2652.49 Avg Reward : -2731.69
Episode : 296 sum_costs : -2627.37 Avg Reward : -2729.84
Episode : 297 sum_costs : -2960.25 Avg Reward : -2731.84
Episode : 298 sum_costs : -2783.58 Avg Reward : -2731.78
Episode : 299 sum_costs : -2459.29 Avg Reward : -2727.11
Episode : 300 sum_costs : -2776.46 Avg Reward : -2729.34
Episode : 301 sum_costs : -2495.92 Avg Reward : -2728.87
Episode : 302 sum_costs : -2496.73 Avg Reward : -2723.91
Episode : 303 sum_costs : -2480.73 Avg Reward : -2719.01
Episode : 304 sum_costs : -2991.98 Avg Reward : -2721.29
Episode : 305 sum_costs : -2510.23 Avg Reward : -2716.56
Episode : 306 sum_costs : -2637.81 Avg Reward : -2713.80
Episode : 307 sum_costs : -2940.88 Avg Reward : -2714.63
Episode : 308 sum_costs : -2783.43 Avg Reward : -2713.75
Episode : 309 sum_costs : -2566.33 Avg Reward : -2708.68
Episode : 310 sum_costs : -2603.95 Avg Reward : -2708.73
Episode : 311 sum_costs : -2619.06 Avg Reward : -2706.77
Episode : 312 sum_costs : -2965.85 Avg Reward : -2707.99
Episode : 313 sum_costs : -2619.70 Avg Reward : -2707.45
Episode : 314 sum_costs : -2730.26 Avg Reward : -2706.60
Episode : 315 sum_costs : -3132.03 Avg Reward : -2708.21
Episode : 316 sum_costs : -2662.73 Avg Reward : -2705.82
Episode : 317 sum_costs : -2632.88 Avg Reward : -2705.61
Traceback (most recent call last):
  File "DQN template.py", line 388, in <module>
    train_dqn(dqn, env, episodes, critic_optimizer, save_dir, goon=False)
  File "DQN template.py", line 269, in train_dqn
    critic_optimizer.apply_gradients(zip(Q_grad, Q.trainable_variables))
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 1174, in apply_gradients
    return super().apply_gradients(grads_and_vars, name=name)
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 650, in apply_gradients
    iteration = self._internal_apply_gradients(grads_and_vars)
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 1200, in _internal_apply_gradients
    return tf.__internal__.distribute.interim.maybe_merge_call(
  File "/home/edo/.local/lib/python3.8/site-packages/tensorflow/python/distribute/merge_call_interim.py", line 51, in maybe_merge_call
    return fn(strategy, *args, **kwargs)
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 1250, in _distributed_apply_gradients_fn
    distribution.extended.update(
  File "/home/edo/.local/lib/python3.8/site-packages/tensorflow/python/distribute/distribute_lib.py", line 2636, in update
    with self._container_strategy().scope():
  File "/home/edo/.local/lib/python3.8/site-packages/tensorflow/python/distribute/distribute_lib.py", line 958, in scope
    return self._extended._scope(self)  # pylint: disable=protected-access
KeyboardInterrupt
Traceback (most recent call last):
  File "DQN template.py", line 388, in <module>
    train_dqn(dqn, env, episodes, critic_optimizer, save_dir, goon=False)
  File "DQN template.py", line 269, in train_dqn
    critic_optimizer.apply_gradients(zip(Q_grad, Q.trainable_variables))
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 1174, in apply_gradients
    return super().apply_gradients(grads_and_vars, name=name)
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 650, in apply_gradients
    iteration = self._internal_apply_gradients(grads_and_vars)
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 1200, in _internal_apply_gradients
    return tf.__internal__.distribute.interim.maybe_merge_call(
  File "/home/edo/.local/lib/python3.8/site-packages/tensorflow/python/distribute/merge_call_interim.py", line 51, in maybe_merge_call
    return fn(strategy, *args, **kwargs)
  File "/home/edo/.local/lib/python3.8/site-packages/keras/optimizers/optimizer.py", line 1250, in _distributed_apply_gradients_fn
    distribution.extended.update(
  File "/home/edo/.local/lib/python3.8/site-packages/tensorflow/python/distribute/distribute_lib.py", line 2636, in update
    with self._container_strategy().scope():
  File "/home/edo/.local/lib/python3.8/site-packages/tensorflow/python/distribute/distribute_lib.py", line 958, in scope
    return self._extended._scope(self)  # pylint: disable=protected-access
KeyboardInterrupt